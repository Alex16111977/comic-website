<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: {{ word.article }} {{ word.word }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/training.css">
</head>
<body>
    <div class="training-container" data-word-id="{{ word.id }}">
        <header class="training-header">
            <a class="back-link" href="../index.html">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <div class="word-title">
                <div class="word-emoji" aria-hidden="true">{{ word.emoji or "üìò" }}</div>
                <div>
                    <p class="word-article">{{ word.article }}</p>
                    <h1>{{ word.word }}</h1>
                    {% if translations.ru or translations.en %}
                    <p class="word-translation">{{ translations.ru or translations.en }}</p>
                    {% endif %}
                </div>
            </div>
            <div class="word-tags">
                {% if word.level %}<span class="tag">–£—Ä–æ–≤–µ–Ω—å {{ word.level }}</span>{% endif %}
                {% if word.gender %}<span class="tag">{{ word.gender }}</span>{% endif %}
                {% if category.name %}
                <span class="tag tag-accent">{{ category.emoji }} {{ category.name }}</span>
                {% elif word.category %}
                <span class="tag">–¢–µ–º–∞: {{ word.category }}</span>
                {% endif %}
                {% if word.phonetic %}<span class="tag">{{ word.phonetic }}</span>{% endif %}
            </div>
        </header>

        <main>
            <section class="training-section">
                <h2>–ë—ã—Å—Ç—Ä—ã–π –æ–±–∑–æ—Ä</h2>
                <div class="overview-grid">
                    <article class="info-card">
                        <h3>–ó–Ω–∞—á–µ–Ω–∏–µ</h3>
                        <p>
                            {% if translations.ru or translations.en %}
                                {% if translations.ru %}<strong>RU:</strong> {{ translations.ru }}<br>{% endif %}
                                {% if translations.en %}<strong>EN:</strong> {{ translations.en }}{% endif %}
                            {% else %}
                                –ü–µ—Ä–µ–≤–æ–¥ –ø–æ–∫–∞ –Ω–µ —É–∫–∞–∑–∞–Ω.
                            {% endif %}
                        </p>
                    </article>
                    <article class="info-card">
                        <h3>–ü—Ä–∏–º–µ—Ä</h3>
                        {% if word.example %}
                        <p class="example">{{ word.example.de or word.example }}</p>
                        <p class="example-translation">{{ word.example.ru or word.example.en }}</p>
                        {% else %}
                        <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–ª–æ–≤–∞.</p>
                        {% endif %}
                    </article>
                    {% if learning_stats %}
                    <article class="info-card stats">
                        <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–ª–æ–≤–∞—Ä—è</h3>
                        <p>–í—Å–µ–≥–æ —Å–ª–æ–≤: {{ learning_stats.total_words }}</p>
                        <p>–ò–∑—É—á–µ–Ω–æ: {{ learning_stats.learned }} ‚Ä¢ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: {{ learning_stats.in_progress }}</p>
                    </article>
                    {% endif %}
                </div>
            </section>

            {% if quiz.has_quiz %}
            <section class="training-section" aria-labelledby="quiz-title">
                <div class="section-header">
                    <h2 id="quiz-title">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h2>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.</p>
                </div>
                <div class="quiz" data-component="quiz">
                    <p class="quiz-question">{{ quiz.question }}</p>
                    <div class="quiz-options">
                        {% for option in quiz.options %}
                        <button class="quiz-option" type="button" data-correct="{{ 'true' if option.is_correct else 'false' }}">{{ option.label }}</button>
                        {% endfor %}
                    </div>
                    <div class="feedback" data-role="quiz-feedback" aria-live="polite"></div>
                </div>
            </section>
            {% endif %}

            {% if match_game.has_game %}
            <section class="training-section" aria-labelledby="match-title">
                <div class="section-header">
                    <h2 id="match-title">–°–æ–±–µ—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫—É</h2>
                    <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–ª—è.</p>
                </div>
                <div class="match-game" data-component="match">
                    <div class="match-grid">
                        <ul class="match-targets">
                            {% for target in match_game.targets %}
                            <li class="match-target">
                                <span class="match-label">{{ target.label }}</span>
                                <div class="match-dropzone" data-key="{{ target.key }}" aria-label="{{ target.label }}"></div>
                            </li>
                            {% endfor %}
                        </ul>
                        <div class="match-tokens" aria-label="–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è">
                            {% for token in match_game.tokens %}
                            <div class="match-token" draggable="true" data-key="{{ token.key }}">{{ token.label }}</div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="feedback" data-role="match-feedback" aria-live="polite"></div>
                </div>
            </section>
            {% endif %}

            <section class="training-section" aria-labelledby="typing-title">
                <div class="section-header">
                    <h2 id="typing-title">–ü–∏—Å—å–º–µ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞</h2>
                    <p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–æ–≤–æ –ø–æ –ø—Ä–∏–º–µ—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.</p>
                </div>
                <div class="typing-task" data-component="typing" data-answer="{{ typing_task.answer | upper }}">
                    {% if typing_task.prompt %}
                    <p class="typing-prompt">{{ typing_task.prompt }}</p>
                    {% else %}
                    <p class="typing-prompt">–ù–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ: {{ word.word }}</p>
                    {% endif %}
                    <label class="typing-label">
                        –í–∞—à –æ—Ç–≤–µ—Ç
                        <input type="text" class="typing-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ">
                    </label>
                    <div class="typing-actions">
                        <button type="button" class="typing-check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                        {% if typing_task.hint %}
                        <button type="button" class="typing-hint" data-hint="{{ typing_task.hint }}">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                        {% endif %}
                    </div>
                    <div class="feedback" data-role="typing-feedback" aria-live="polite"></div>
                </div>
            </section>

            {% if related_words %}
            <section class="training-section" aria-labelledby="related-title">
                <h2 id="related-title">–°–æ—Å–µ–¥–Ω–∏–µ —Å–ª–æ–≤–∞</h2>
                <div class="related-grid">
                    {% for related in related_words %}
                    <article class="related-card">
                        <h3>{{ related.article }} {{ related.word }}</h3>
                        {% if related.translation_ru or related.translation_en %}
                        <p>{{ related.translation_ru or related.translation_en }}</p>
                        {% endif %}
                        <a href="{{ related.id }}.html" class="related-link">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è ‚Üí</a>
                    </article>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </main>
    </div>
    <script src="../static/js/training.js"></script>
</body>
</html>
