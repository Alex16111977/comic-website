"""
–¢–µ—Å—Ç: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–ü–æ–¥–±–æ—Ä —Å–ª–æ–≤"
–î–∞—Ç–∞: 2025-09-20
–ú–µ—Ç–∞: –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–ï —Å–ª–æ–≤–∞ —Ñ–∞–∑—ã
"""

import json
import re
from pathlib import Path

print("[TEST] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è '–ü–æ–¥–±–æ—Ä —Å–ª–æ–≤'")
print("=" * 60)

# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤ JS –∫–æ–¥–µ –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π synonymGroups –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
js_file = Path(r"F:\AiKlientBank\KingLearComic\generators\js_lira.py")
with open(js_file, 'r', encoding='utf-8') as f:
    js_content = f.read()

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è wordMatchingGroups
if 'wordMatchingGroups' in js_content:
    print("[OK] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è wordMatchingGroups –≤–º–µ—Å—Ç–æ synonymGroups")
else:
    print("[WARN] wordMatchingGroups –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–¥–µ")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–µ—Ç —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞ —Å synonyms
if 'if (word.synonyms && word.synonyms.length > 0)' in js_content:
    print("[ERROR] –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –≤—Å–µ –µ—â–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç!")
else:
    print("[OK] –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ —É–¥–∞–ª–µ–Ω")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π –∫–æ–¥
if 'if (word.word && word.translation)' in js_content:
    print("[OK] –ù–æ–≤—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–ï —Å–ª–æ–≤–∞ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏")
else:
    print("[ERROR] –ù–æ–≤—ã–π –∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω")

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —à–∞–±–ª–æ–Ω HTML
template_file = Path(r"F:\AiKlientBank\KingLearComic\templates\journey.html")
with open(template_file, 'r', encoding='utf-8') as f:
    template_content = f.read()

if 'üîó –ü–æ–¥–±–æ—Ä —Å–ª–æ–≤' in template_content:
    print("[OK] –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ '–ü–æ–¥–±–æ—Ä —Å–ª–æ–≤' –≤ —à–∞–±–ª–æ–Ω–µ")
elif 'ü§ù –°–∏–Ω–æ–Ω–∏–º—ã' in template_content:
    print("[ERROR] –°—Ç–∞—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ '–°–∏–Ω–æ–Ω–∏–º—ã' –≤—Å–µ –µ—â–µ –≤ —à–∞–±–ª–æ–Ω–µ!")
else:
    print("[WARN] –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π HTML
output_file = Path(r"F:\AiKlientBank\KingLearComic\output\journeys\king_lear.html")
if output_file.exists():
    with open(output_file, 'r', encoding='utf-8') as f:
        output_content = f.read()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
    if '–ù–µ–º–µ—Ü–∫–∏–µ' in output_content and '–†—É—Å—Å–∫–∏–µ' in output_content:
        print("[OK] –ö–æ–ª–æ–Ω–∫–∏ –Ω–∞–∑–≤–∞–Ω—ã '–ù–µ–º–µ—Ü–∫–∏–µ' –∏ '–†—É—Å—Å–∫–∏–µ'")
    else:
        print("[WARN] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –≤—ã–≤–æ–¥–µ")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –µ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø–æ–¥–±–æ—Ä–∞
    if 'buildPairMatchingActivity' in output_content:
        print("[OK] –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ–¥–±–æ—Ä–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ —Å–ª–æ–≤–∞ —Ñ–∞–∑—ã
    if 'phase.words.forEach((word, wordIdx)' in output_content:
        print("[OK] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –í–°–ï —Å–ª–æ–≤–∞ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑—ã")
else:
    print("[ERROR] –§–∞–π–ª king_lear.html –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ output")

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–æ–ª–µ synonyms –±–æ–ª—å—à–µ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –¥–ª—è —Å–ª–æ–≤–∞—Ä—è
if "'synonyms': synonyms," in js_content:
    print("[ERROR] –ü–æ–ª–µ synonyms –≤—Å–µ –µ—â–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ª–æ–≤–∞—Ä—å!")
else:
    print("[OK] –ü–æ–ª–µ synonyms —É–¥–∞–ª–µ–Ω–æ –∏–∑ —Å–ª–æ–≤–∞—Ä—è")

print("\n" + "=" * 60)
print("[SUMMARY] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ")
print("\n–ò–∑–º–µ–Ω–µ–Ω–∏—è:")
print("1. –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ '–°–∏–Ω–æ–Ω–∏–º—ã' -> '–ü–æ–¥–±–æ—Ä —Å–ª–æ–≤'")
print("2. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –í–°–ï —Å–ª–æ–≤–∞ —Ñ–∞–∑—ã (–Ω–µ —Ç–æ–ª—å–∫–æ —Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏)")
print("3. –ö–æ–ª–æ–Ω–∫–∏: '–ù–µ–º–µ—Ü–∫–∏–µ' –∏ '–†—É—Å—Å–∫–∏–µ'") 
print("4. –†—É—Å—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤–∫–ª—é—á–∞—é—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ —Å–∫–æ–±–∫–∞—Ö")
print("5. –ü–æ–ª–µ synonyms –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è")
